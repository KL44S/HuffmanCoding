!function(){angular.module("myApp").factory("compactCodeGeneratorService",["constantsModel",function(a){function c(a,b){if(a<=b)return 0;var c=a;do{c=c-b+1}while(c>b);return-1*(c-b)}function d(a,b){var d=b.source.symbols.length,e=c(d,b.r);for(i=0;i<e;i++)a.push({symbol:"",probability:0,codeWord:""})}function e(a,b){a.forEach(function(a,c){a.codeWord+=b[c]})}function f(a){a.forEach(function(a){a.codeWord=""})}function g(a){if(f(a.source.symbols),a.r>=a.source.symbols.length)e(a.source.symbols,a.codeAlphabet);else{var b=a.source.symbols.slice(),c=[],g=[];d(b,a),g.push(b);for(var j=b.length;j>a.r;){var k=g[g.length-1],l=[],m=0;k.sort(function(a,b){return a.probability-b.probability}),k.forEach(function(b,d){d<a.r&&(m+=b.probability),d==a.r-1?(l.push({symbol:b.symbol,probability:m,codeWord:""}),c.push(b.symbol)):d>=a.r&&l.push(b)}),g.push(l),j=l.length}for(i=g.length-1;i>=0;i--){var k;i<g.length-1?(k=g[i].slice(0,a.r),k.forEach(function(a){var b=h(g[i+1],c[i]);a.codeWord=b.codeWord})):k=g[i],e(k,a.codeAlphabet)}}}function h(a,b){a.forEach(function(a){if(a.symbol==b)return a})}function j(b){var c=b.source.text;for(b.codedText="",i=0;i<c.length;i++){var d=h(b.source.symbols,c.charAt(i));0!=i&&(b.codedText+=a.separator),b.codedText+=d.codeWord}}function k(a){var b=0;a.source.symbols.forEach(function(a){b+=a.probability*a.codeWord.length}),a.L=b}function l(a){var b=a.source.entropy/a.L;a.preformance=b}function h(a,b){for(var e,c=0,d=!1;c<a.length&&!d;)e=a[c],e.symbol==b&&(d=!0),c++;if(d)return e;throw"Symbol not found"}var b={};return b.encode=function(a){g(a),k(a),l(a),j(a)},b.getErrorMessages=function(b){var c=[];return void 0==b.r||null==b.r?c.push(a.notEmptyFieldErrorMessage):(b.r<a.minR&&c.push(a.lessThanFieldErrorMessage+a.minR),b.r>a.codePosibleSymbols.length&&c.push(a.greaterThanFieldErrorMessage+a.codePosibleSymbols.length)),c},b.resetCode=function(a){a.codedText="",a.source.symbols.forEach(function(a){a.codeWord=""}),a.codeAlphabet=[]},b}])}();